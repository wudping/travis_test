dist: xenial
sudo: required
language: c++
compiler: g++
os: linux
before_install:
- test "${TRAVIS_BRANCH}" != 'coverity_scan' -o "${TRAVIS_JOB_NUMBER##*.}" = '1' ||
  exit 0
- echo -n | openssl s_client -connect scan.coverity.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END
  CERTIFICATE-/p' | sudo tee -a /etc/ssl/certs/ca-
- pip install --user cpp-coveralls
- sudo apt-get -qq update
- export COVERITY_SCAN_TOKEN=iT5S_GvmP_VDuSkHmwduTA

env:
  global:
  - secure: RO6Km2oZnY/Z97E9hcACIoiGpOEneJhGemr2eFp9XyIjFmnMnGtGPAEKsNrI4mVKQBeVmA00BPi5T6Hu53bhuELOL6G/EFdaJJPM3y78WUnrCMaThI8v7TkXqPSPYB8S7pB8eYGa/nSy9WMeMZM2XKLM3xQ2xEaG0+5XMZN0KUyV5oYtvtGukxayBG5s49DisWEU+bEy5z2WEDAX7Ac6Aadyt6rxmge0I8gN6PVS4p5Z1SOjrCvQ5l+7MHUaWtdzuQOZWuZKN0/uJPHQq+E10Re5YDwpYqg1aqtzz6A8DtsnnN3Qa/tZRM0+8aOopjAzo9/rW9hMh5M7izEmI7elX/S0R9vQ0h2n/zQs6A8h4l3u0eHmDCTFBVbXQXajP5G4FYhgvo5I0EaXwjspIS3DiZ+ndf/3ZHk261KGMP+nYUs9fnJng9lDMGkvIaO4OpEHClDmbYtb0/Kjopp+F4QL1pEiiTTBRzBTklZNR00P+DpJp46aQCnCVB2j9WtnVgDejoWF48dxbhImEZqhPN/VK7OuUe8zW2R7TDHohUuevR7aIhgVe2ca8f80YGUYPWCgyU9l+DrGjXbJQTDsG8O8+SpqZr5Nckxocmfs9pxksLl8sltrSS9OWncwLuipsc9o2qBIJjEZjBFnD4NMVdnjxsNfiP+xk9odhAAEbAE8ytE=
addons:
  coverity_scan:
    project:
      name: travis_test
      description: Build submitted via Travis CI
      token: iT5S_GvmP_VDuSkHmwduTA
    notification_email: "<email address>"
    build_command_prepend: ''
    build_command: make -j8
    branch_pattern: coverity_scan
script:
- make -j8
after_success:
- coveralls --exclude lib --exclude tests --gcov-options '\-lp'
notifications:
  email:
    on_success: always
    on_failure: always
